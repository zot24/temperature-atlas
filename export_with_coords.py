#!/usr/bin/env python3
"""
Export city temperature data to JSON with coordinates using geocoding.
"""

import sqlite3
import json

def get_cities_from_db():
    """Get all cities with temperature data from the database."""
    conn = sqlite3.connect('city_temperatures.db')
    conn.row_factory = sqlite3.Row
    cursor = conn.cursor()

    cursor.execute('''
        SELECT
            c.id,
            c.name as city,
            coun.name as country,
            cont.name as continent,
            t.jan, t.feb, t.mar, t.apr, t.may, t.jun,
            t.jul, t.aug, t.sep, t.oct, t.nov, t.dec_temp as dec,
            t.yearly_avg
        FROM cities c
        JOIN countries coun ON c.country_id = coun.id
        JOIN continents cont ON coun.continent_id = cont.id
        JOIN temperatures t ON t.city_id = c.id
    ''')

    cities = [dict(row) for row in cursor.fetchall()]
    conn.close()
    return cities

# Pre-defined coordinates for major cities to avoid rate limiting
CITY_COORDS = {
    # Africa
    ("Algiers", "Algeria"): (36.7538, 3.0588),
    ("Tamanrasset", "Algeria"): (22.7850, 5.5228),
    ("Reggane", "Algeria"): (26.7167, 0.1667),
    ("Luanda", "Angola"): (-8.8390, 13.2894),
    ("Cotonou", "Benin"): (6.3654, 2.4183),
    ("Gaborone", "Botswana"): (-24.6282, 25.9231),
    ("Ouagadougou", "Burkina Faso"): (12.3714, -1.5197),
    ("Bujumbura", "Burundi"): (-3.3614, 29.3599),
    ("Douala", "Cameroon"): (4.0511, 9.7679),
    ("Yaoundé", "Cameroon"): (3.8480, 11.5021),
    ("Praia", "Cape Verde"): (14.9315, -23.5087),
    ("Bangui", "Central African Republic"): (4.3947, 18.5582),
    ("N'Djamena", "Chad"): (12.1348, 15.0557),
    ("Abéché", "Chad"): (13.8292, 20.8324),
    ("Moroni", "Comoros"): (-11.7022, 43.2551),
    ("Kinshasa", "Democratic Republic of the Congo"): (-4.4419, 15.2663),
    ("Brazzaville", "Republic of the Congo"): (-4.2634, 15.2429),
    ("Djibouti", "Djibouti"): (11.5721, 43.1456),
    ("Cairo", "Egypt"): (30.0444, 31.2357),
    ("Alexandria", "Egypt"): (31.2001, 29.9187),
    ("Aswan", "Egypt"): (24.0889, 32.8998),
    ("Malabo", "Equatorial Guinea"): (3.7504, 8.7371),
    ("Asmara", "Eritrea"): (15.3229, 38.9251),
    ("Assab", "Eritrea"): (13.0092, 42.7394),
    ("Addis Ababa", "Ethiopia"): (8.9806, 38.7578),
    ("Libreville", "Gabon"): (0.4162, 9.4673),
    ("Banjul", "Gambia"): (13.4549, -16.5790),
    ("Accra", "Ghana"): (5.6037, -0.1870),
    ("Conakry", "Guinea"): (9.6412, -13.5784),
    ("Bissau", "Guinea-Bissau"): (11.8037, -15.1804),
    ("Nairobi", "Kenya"): (-1.2921, 36.8219),
    ("Mombasa", "Kenya"): (-4.0435, 39.6682),
    ("Garissa", "Kenya"): (-0.4536, 39.6401),
    ("Lodwar", "Kenya"): (3.1167, 35.6000),
    ("Maseru", "Lesotho"): (-29.3167, 27.4833),
    ("Monrovia", "Liberia"): (6.2907, -10.7605),
    ("Tripoli", "Libya"): (32.8872, 13.1913),
    ("Benghazi", "Libya"): (32.1194, 20.0867),
    ("Antananarivo", "Madagascar"): (-18.8792, 47.5079),
    ("Lilongwe", "Malawi"): (-13.9626, 33.7741),
    ("Bamako", "Mali"): (12.6392, -8.0029),
    ("Ségou", "Mali"): (13.4317, -6.2658),
    ("Nouakchott", "Mauritania"): (18.0735, -15.9582),
    ("Port Louis", "Mauritius"): (-20.1609, 57.5012),
    ("Casablanca", "Morocco"): (33.5731, -7.5898),
    ("Marrakesh", "Morocco"): (31.6295, -7.9811),
    ("Maputo", "Mozambique"): (-25.9692, 32.5732),
    ("Windhoek", "Namibia"): (-22.5609, 17.0658),
    ("Niamey", "Niger"): (13.5137, 2.1098),
    ("Lagos", "Nigeria"): (6.5244, 3.3792),
    ("Abuja", "Nigeria"): (9.0765, 7.3986),
    ("Kano", "Nigeria"): (12.0022, 8.5920),
    ("Kigali", "Rwanda"): (-1.9403, 30.0587),
    ("São Tomé", "São Tomé and Príncipe"): (0.3365, 6.7273),
    ("Dakar", "Senegal"): (14.7167, -17.4677),
    ("Victoria", "Seychelles"): (-4.6191, 55.4513),
    ("Freetown", "Sierra Leone"): (8.4657, -13.2317),
    ("Mogadishu", "Somalia"): (2.0469, 45.3182),
    ("Bosaso", "Somalia"): (11.2756, 49.1878),
    ("Johannesburg", "South Africa"): (-26.2041, 28.0473),
    ("Cape Town", "South Africa"): (-33.9249, 18.4241),
    ("Durban", "South Africa"): (-29.8587, 31.0218),
    ("Pretoria", "South Africa"): (-25.7479, 28.2293),
    ("Juba", "South Sudan"): (4.8594, 31.5713),
    ("Khartoum", "Sudan"): (15.5007, 32.5599),
    ("Mbabane", "Eswatini"): (-26.3054, 31.1367),
    ("Dar es Salaam", "Tanzania"): (-6.7924, 39.2083),
    ("Dodoma", "Tanzania"): (-6.1630, 35.7516),
    ("Lomé", "Togo"): (6.1256, 1.2254),
    ("Tunis", "Tunisia"): (36.8065, 10.1815),
    ("Kampala", "Uganda"): (0.3476, 32.5825),
    ("Lusaka", "Zambia"): (-15.3875, 28.3228),
    ("Harare", "Zimbabwe"): (-17.8252, 31.0335),

    # Asia
    ("Kabul", "Afghanistan"): (34.5553, 69.2075),
    ("Yerevan", "Armenia"): (40.1792, 44.4991),
    ("Baku", "Azerbaijan"): (40.4093, 49.8671),
    ("Manama", "Bahrain"): (26.2285, 50.5860),
    ("Dhaka", "Bangladesh"): (23.8103, 90.4125),
    ("Chittagong", "Bangladesh"): (22.3569, 91.7832),
    ("Thimphu", "Bhutan"): (27.4728, 89.6390),
    ("Bandar Seri Begawan", "Brunei"): (4.9031, 114.9398),
    ("Phnom Penh", "Cambodia"): (11.5564, 104.9282),
    ("Beijing", "China"): (39.9042, 116.4074),
    ("Shanghai", "China"): (31.2304, 121.4737),
    ("Guangzhou", "China"): (23.1291, 113.2644),
    ("Hong Kong", "China"): (22.3193, 114.1694),
    ("Chongqing", "China"): (29.4316, 106.9123),
    ("Harbin", "China"): (45.8038, 126.5350),
    ("Lhasa", "China"): (29.6500, 91.1000),
    ("Ürümqi", "China"): (43.8256, 87.6168),
    ("Kunming", "China"): (25.0389, 102.7183),
    ("Shenyang", "China"): (41.8057, 123.4315),
    ("Wuhan", "China"): (30.5928, 114.3055),
    ("Chengdu", "China"): (30.5728, 104.0668),
    ("Nicosia", "Cyprus"): (35.1856, 33.3823),
    ("Tbilisi", "Georgia"): (41.7151, 44.8271),
    ("New Delhi", "India"): (28.6139, 77.2090),
    ("Mumbai", "India"): (19.0760, 72.8777),
    ("Kolkata", "India"): (22.5726, 88.3639),
    ("Chennai", "India"): (13.0827, 80.2707),
    ("Bangalore", "India"): (12.9716, 77.5946),
    ("Hyderabad", "India"): (17.3850, 78.4867),
    ("Srinagar", "India"): (34.0837, 74.7973),
    ("Thiruvananthapuram", "India"): (8.5241, 76.9366),
    ("Jakarta", "Indonesia"): (-6.2088, 106.8456),
    ("Surabaya", "Indonesia"): (-7.2575, 112.7521),
    ("Medan", "Indonesia"): (3.5952, 98.6722),
    ("Bandung", "Indonesia"): (-6.9175, 107.6191),
    ("Makassar", "Indonesia"): (-5.1477, 119.4327),
    ("Denpasar", "Indonesia"): (-8.6705, 115.2126),
    ("Jayapura", "Indonesia"): (-2.5916, 140.6690),
    ("Manado", "Indonesia"): (1.4748, 124.8421),
    ("Tehran", "Iran"): (35.6892, 51.3890),
    ("Isfahan", "Iran"): (32.6546, 51.6680),
    ("Mashhad", "Iran"): (36.2605, 59.6168),
    ("Tabriz", "Iran"): (38.0800, 46.2919),
    ("Baghdad", "Iraq"): (33.3152, 44.3661),
    ("Basra", "Iraq"): (30.5081, 47.7835),
    ("Mosul", "Iraq"): (36.3350, 43.1189),
    ("Jerusalem", "Israel"): (31.7683, 35.2137),
    ("Tel Aviv", "Israel"): (32.0853, 34.7818),
    ("Tokyo", "Japan"): (35.6762, 139.6503),
    ("Osaka", "Japan"): (34.6937, 135.5023),
    ("Sapporo", "Japan"): (43.0618, 141.3545),
    ("Naha", "Japan"): (26.2124, 127.6809),
    ("Nagoya", "Japan"): (35.1815, 136.9066),
    ("Fukuoka", "Japan"): (33.5904, 130.4017),
    ("Amman", "Jordan"): (31.9454, 35.9284),
    ("Almaty", "Kazakhstan"): (43.2220, 76.8512),
    ("Astana", "Kazakhstan"): (51.1605, 71.4704),
    ("Kuwait City", "Kuwait"): (29.3759, 47.9774),
    ("Bishkek", "Kyrgyzstan"): (42.8746, 74.5698),
    ("Vientiane", "Laos"): (17.9757, 102.6331),
    ("Beirut", "Lebanon"): (33.8938, 35.5018),
    ("Kuala Lumpur", "Malaysia"): (3.1390, 101.6869),
    ("Malé", "Maldives"): (4.1755, 73.5093),
    ("Ulaanbaatar", "Mongolia"): (47.8864, 106.9057),
    ("Yangon", "Myanmar"): (16.8661, 96.1951),
    ("Mandalay", "Myanmar"): (21.9588, 96.0891),
    ("Kathmandu", "Nepal"): (27.7172, 85.3240),
    ("Muscat", "Oman"): (23.5880, 58.3829),
    ("Salalah", "Oman"): (17.0151, 54.0924),
    ("Islamabad", "Pakistan"): (33.6844, 73.0479),
    ("Karachi", "Pakistan"): (24.8607, 67.0011),
    ("Lahore", "Pakistan"): (31.5497, 74.3436),
    ("Peshawar", "Pakistan"): (34.0151, 71.5249),
    ("Manila", "Philippines"): (14.5995, 120.9842),
    ("Cebu City", "Philippines"): (10.3157, 123.8854),
    ("Davao City", "Philippines"): (7.1907, 125.4553),
    ("Doha", "Qatar"): (25.2854, 51.5310),
    ("Riyadh", "Saudi Arabia"): (24.7136, 46.6753),
    ("Jeddah", "Saudi Arabia"): (21.5433, 39.1728),
    ("Mecca", "Saudi Arabia"): (21.3891, 39.8579),
    ("Singapore", "Singapore"): (1.3521, 103.8198),
    ("Seoul", "South Korea"): (37.5665, 126.9780),
    ("Busan", "South Korea"): (35.1796, 129.0756),
    ("Colombo", "Sri Lanka"): (6.9271, 79.8612),
    ("Damascus", "Syria"): (33.5138, 36.2765),
    ("Aleppo", "Syria"): (36.2021, 37.1343),
    ("Taipei", "Taiwan"): (25.0330, 121.5654),
    ("Dushanbe", "Tajikistan"): (38.5598, 68.7740),
    ("Bangkok", "Thailand"): (13.7563, 100.5018),
    ("Chiang Mai", "Thailand"): (18.7883, 98.9853),
    ("Dili", "Timor-Leste"): (-8.5569, 125.5603),
    ("Ankara", "Turkey"): (39.9334, 32.8597),
    ("Istanbul", "Turkey"): (41.0082, 28.9784),
    ("Antalya", "Turkey"): (36.8969, 30.7133),
    ("Ashgabat", "Turkmenistan"): (37.9601, 58.3261),
    ("Abu Dhabi", "United Arab Emirates"): (24.4539, 54.3773),
    ("Dubai", "United Arab Emirates"): (25.2048, 55.2708),
    ("Tashkent", "Uzbekistan"): (41.2995, 69.2401),
    ("Hanoi", "Vietnam"): (21.0285, 105.8542),
    ("Ho Chi Minh City", "Vietnam"): (10.8231, 106.6297),
    ("Sanaa", "Yemen"): (15.3694, 44.1910),
    ("Aden", "Yemen"): (12.7855, 45.0187),
    ("Dikson", "Russia"): (73.5069, 80.5297),
    ("Yakutsk", "Russia"): (62.0355, 129.6755),
    ("Anadyr", "Russia"): (64.7340, 177.5097),
    ("Vladivostok", "Russia"): (43.1332, 131.9113),
    ("Novosibirsk", "Russia"): (55.0084, 82.9357),
    ("Petropavlovsk-Kamchatsky", "Russia"): (53.0452, 158.6483),
    ("Magadan", "Russia"): (59.5612, 150.8303),
    ("Khabarovsk", "Russia"): (48.4827, 135.0837),
    ("Irkutsk", "Russia"): (52.2978, 104.2964),
    ("Omsk", "Russia"): (54.9885, 73.3242),
    ("Krasnoyarsk", "Russia"): (56.0153, 92.8932),
    ("Yekaterinburg", "Russia"): (56.8389, 60.6057),
    ("Chelyabinsk", "Russia"): (55.1644, 61.4368),

    # Europe
    ("Tirana", "Albania"): (41.3275, 19.8187),
    ("Andorra la Vella", "Andorra"): (42.5063, 1.5218),
    ("Vienna", "Austria"): (48.2082, 16.3738),
    ("Minsk", "Belarus"): (53.9006, 27.5590),
    ("Brussels", "Belgium"): (50.8503, 4.3517),
    ("Sarajevo", "Bosnia and Herzegovina"): (43.8563, 18.4131),
    ("Sofia", "Bulgaria"): (42.6977, 23.3219),
    ("Zagreb", "Croatia"): (45.8150, 15.9819),
    ("Prague", "Czech Republic"): (50.0755, 14.4378),
    ("Copenhagen", "Denmark"): (55.6761, 12.5683),
    ("Tallinn", "Estonia"): (59.4370, 24.7536),
    ("Helsinki", "Finland"): (60.1699, 24.9384),
    ("Oulu", "Finland"): (65.0121, 25.4651),
    ("Paris", "France"): (48.8566, 2.3522),
    ("Marseille", "France"): (43.2965, 5.3698),
    ("Lyon", "France"): (45.7640, 4.8357),
    ("Nice", "France"): (43.7102, 7.2620),
    ("Berlin", "Germany"): (52.5200, 13.4050),
    ("Munich", "Germany"): (48.1351, 11.5820),
    ("Hamburg", "Germany"): (53.5511, 9.9937),
    ("Frankfurt", "Germany"): (50.1109, 8.6821),
    ("Athens", "Greece"): (37.9838, 23.7275),
    ("Thessaloniki", "Greece"): (40.6401, 22.9444),
    ("Budapest", "Hungary"): (47.4979, 19.0402),
    ("Reykjavik", "Iceland"): (64.1466, -21.9426),
    ("Dublin", "Ireland"): (53.3498, -6.2603),
    ("Rome", "Italy"): (41.9028, 12.4964),
    ("Milan", "Italy"): (45.4642, 9.1900),
    ("Naples", "Italy"): (40.8518, 14.2681),
    ("Riga", "Latvia"): (56.9496, 24.1052),
    ("Vaduz", "Liechtenstein"): (47.1410, 9.5209),
    ("Vilnius", "Lithuania"): (54.6872, 25.2797),
    ("Luxembourg", "Luxembourg"): (49.6116, 6.1319),
    ("Skopje", "North Macedonia"): (41.9981, 21.4254),
    ("Valletta", "Malta"): (35.8989, 14.5146),
    ("Chișinău", "Moldova"): (47.0105, 28.8638),
    ("Monaco", "Monaco"): (43.7384, 7.4246),
    ("Podgorica", "Montenegro"): (42.4304, 19.2594),
    ("Amsterdam", "Netherlands"): (52.3676, 4.9041),
    ("Oslo", "Norway"): (59.9139, 10.7522),
    ("Bergen", "Norway"): (60.3913, 5.3221),
    ("Tromsø", "Norway"): (69.6492, 18.9553),
    ("Warsaw", "Poland"): (52.2297, 21.0122),
    ("Kraków", "Poland"): (50.0647, 19.9450),
    ("Lisbon", "Portugal"): (38.7223, -9.1393),
    ("Porto", "Portugal"): (41.1579, -8.6291),
    ("Bucharest", "Romania"): (44.4268, 26.1025),
    ("Moscow", "Russia"): (55.7558, 37.6173),
    ("Saint Petersburg", "Russia"): (59.9311, 30.3609),
    ("Sochi", "Russia"): (43.6028, 39.7342),
    ("Murmansk", "Russia"): (68.9585, 33.0827),
    ("Arkhangelsk", "Russia"): (64.5401, 40.5433),
    ("Kaliningrad", "Russia"): (54.7104, 20.4522),
    ("Belgrade", "Serbia"): (44.7866, 20.4489),
    ("Bratislava", "Slovakia"): (48.1486, 17.1077),
    ("Ljubljana", "Slovenia"): (46.0569, 14.5058),
    ("Madrid", "Spain"): (40.4168, -3.7038),
    ("Barcelona", "Spain"): (41.3851, 2.1734),
    ("Seville", "Spain"): (37.3891, -5.9845),
    ("Valencia", "Spain"): (39.4699, -0.3763),
    ("Stockholm", "Sweden"): (59.3293, 18.0686),
    ("Gothenburg", "Sweden"): (57.7089, 11.9746),
    ("Kiruna", "Sweden"): (67.8558, 20.2253),
    ("Bern", "Switzerland"): (46.9480, 7.4474),
    ("Zurich", "Switzerland"): (47.3769, 8.5417),
    ("Geneva", "Switzerland"): (46.2044, 6.1432),
    ("Kyiv", "Ukraine"): (50.4501, 30.5234),
    ("Odesa", "Ukraine"): (46.4825, 30.7233),
    ("Kharkiv", "Ukraine"): (49.9935, 36.2304),
    ("London", "United Kingdom"): (51.5074, -0.1278),
    ("Edinburgh", "United Kingdom"): (55.9533, -3.1883),
    ("Manchester", "United Kingdom"): (53.4808, -2.2426),
    ("Birmingham", "United Kingdom"): (52.4862, -1.8904),
    ("Glasgow", "United Kingdom"): (55.8642, -4.2518),

    # North America
    ("Nassau", "Bahamas"): (25.0343, -77.3963),
    ("Bridgetown", "Barbados"): (13.1132, -59.5988),
    ("Belmopan", "Belize"): (17.2510, -88.7590),
    ("Hamilton", "Bermuda"): (32.2949, -64.7810),
    ("Ottawa", "Canada"): (45.4215, -75.6972),
    ("Toronto", "Canada"): (43.6532, -79.3832),
    ("Montreal", "Canada"): (45.5017, -73.5673),
    ("Vancouver", "Canada"): (49.2827, -123.1207),
    ("Calgary", "Canada"): (51.0447, -114.0719),
    ("Edmonton", "Canada"): (53.5461, -113.4938),
    ("Winnipeg", "Canada"): (49.8951, -97.1384),
    ("Halifax", "Canada"): (44.6488, -63.5752),
    ("Victoria", "Canada"): (48.4284, -123.3656),
    ("Yellowknife", "Canada"): (62.4540, -114.3718),
    ("Whitehorse", "Canada"): (60.7212, -135.0568),
    ("Iqaluit", "Canada"): (63.7467, -68.5170),
    ("Alert", "Canada"): (82.5018, -62.3481),
    ("Gjoa Haven", "Canada"): (68.6356, -95.8503),
    ("St. John's", "Canada"): (47.5615, -52.7126),
    ("San José", "Costa Rica"): (9.9281, -84.0907),
    ("Havana", "Cuba"): (23.1136, -82.3666),
    ("Santo Domingo", "Dominican Republic"): (18.4861, -69.9312),
    ("San Salvador", "El Salvador"): (13.6929, -89.2182),
    ("Nuuk", "Greenland"): (64.1814, -51.6941),
    ("Guatemala City", "Guatemala"): (14.6349, -90.5069),
    ("Port-au-Prince", "Haiti"): (18.5944, -72.3074),
    ("Tegucigalpa", "Honduras"): (14.0723, -87.1921),
    ("Kingston", "Jamaica"): (18.0179, -76.8099),
    ("Mexico City", "Mexico"): (19.4326, -99.1332),
    ("Guadalajara", "Mexico"): (20.6597, -103.3496),
    ("Monterrey", "Mexico"): (25.6866, -100.3161),
    ("Cancún", "Mexico"): (21.1619, -86.8515),
    ("Tijuana", "Mexico"): (32.5149, -117.0382),
    ("Mérida", "Mexico"): (20.9674, -89.5926),
    ("Chihuahua", "Mexico"): (28.6353, -106.0889),
    ("Hermosillo", "Mexico"): (29.0729, -110.9559),
    ("Acapulco", "Mexico"): (16.8531, -99.8237),
    ("Veracruz", "Mexico"): (19.1738, -96.1342),
    ("León", "Mexico"): (21.1250, -101.6860),
    ("Managua", "Nicaragua"): (12.1150, -86.2362),
    ("Panama City", "Panama"): (8.9824, -79.5199),
    ("San Juan", "Puerto Rico"): (18.4655, -66.1057),
    ("Port of Spain", "Trinidad and Tobago"): (10.6596, -61.5086),
    ("Washington, D.C.", "United States"): (38.9072, -77.0369),
    ("New York City", "United States"): (40.7128, -74.0060),
    ("Los Angeles", "United States"): (34.0522, -118.2437),
    ("Chicago", "United States"): (41.8781, -87.6298),
    ("Houston", "United States"): (29.7604, -95.3698),
    ("Phoenix", "United States"): (33.4484, -112.0740),
    ("Philadelphia", "United States"): (39.9526, -75.1652),
    ("San Antonio", "United States"): (29.4241, -98.4936),
    ("San Diego", "United States"): (32.7157, -117.1611),
    ("Dallas", "United States"): (32.7767, -96.7970),
    ("San Francisco", "United States"): (37.7749, -122.4194),
    ("Seattle", "United States"): (47.6062, -122.3321),
    ("Denver", "United States"): (39.7392, -104.9903),
    ("Boston", "United States"): (42.3601, -71.0589),
    ("Miami", "United States"): (25.7617, -80.1918),
    ("Atlanta", "United States"): (33.7490, -84.3880),
    ("Las Vegas", "United States"): (36.1699, -115.1398),
    ("Portland", "United States"): (45.5155, -122.6789),
    ("Minneapolis", "United States"): (44.9778, -93.2650),
    ("Detroit", "United States"): (42.3314, -83.0458),
    ("New Orleans", "United States"): (29.9511, -90.0715),
    ("Cleveland", "United States"): (41.4993, -81.6944),
    ("Honolulu", "United States"): (21.3069, -157.8583),
    ("Anchorage", "United States"): (61.2181, -149.9003),
    ("Fairbanks", "United States"): (64.8378, -147.7164),
    ("Salt Lake City", "United States"): (40.7608, -111.8910),
    ("Kansas City", "United States"): (39.0997, -94.5786),
    ("St. Louis", "United States"): (38.6270, -90.1994),
    ("Tampa", "United States"): (27.9506, -82.4572),
    ("Pittsburgh", "United States"): (40.4406, -79.9959),
    ("Cincinnati", "United States"): (39.1031, -84.5120),
    ("Orlando", "United States"): (28.5383, -81.3792),
    ("Austin", "United States"): (30.2672, -97.7431),
    ("Indianapolis", "United States"): (39.7684, -86.1581),
    ("Columbus", "United States"): (39.9612, -82.9988),
    ("Charlotte", "United States"): (35.2271, -80.8431),
    ("San Jose", "United States"): (37.3382, -121.8863),
    ("Jacksonville", "United States"): (30.3322, -81.6557),
    ("Nashville", "United States"): (36.1627, -86.7816),
    ("Oklahoma City", "United States"): (35.4676, -97.5164),
    ("El Paso", "United States"): (31.7619, -106.4850),
    ("Memphis", "United States"): (35.1495, -90.0490),
    ("Louisville", "United States"): (38.2527, -85.7585),
    ("Baltimore", "United States"): (39.2904, -76.6122),
    ("Milwaukee", "United States"): (43.0389, -87.9065),
    ("Albuquerque", "United States"): (35.0844, -106.6504),
    ("Tucson", "United States"): (32.2226, -110.9747),
    ("Sacramento", "United States"): (38.5816, -121.4944),
    ("Raleigh", "United States"): (35.7796, -78.6382),
    ("Buffalo", "United States"): (42.8864, -78.8784),

    # South America
    ("Buenos Aires", "Argentina"): (-34.6037, -58.3816),
    ("Córdoba", "Argentina"): (-31.4201, -64.1888),
    ("Rosario", "Argentina"): (-32.9468, -60.6393),
    ("Mendoza", "Argentina"): (-32.8895, -68.8458),
    ("San Miguel de Tucumán", "Argentina"): (-26.8083, -65.2176),
    ("La Plata", "Argentina"): (-34.9215, -57.9545),
    ("Mar del Plata", "Argentina"): (-38.0055, -57.5426),
    ("Salta", "Argentina"): (-24.7821, -65.4232),
    ("Santa Fe", "Argentina"): (-31.6333, -60.7000),
    ("San Juan", "Argentina"): (-31.5375, -68.5364),
    ("Neuquén", "Argentina"): (-38.9516, -68.0591),
    ("Comodoro Rivadavia", "Argentina"): (-45.8656, -67.4823),
    ("Bahía Blanca", "Argentina"): (-38.7196, -62.2724),
    ("Ushuaia", "Argentina"): (-54.8019, -68.3030),
    ("San Carlos de Bariloche", "Argentina"): (-41.1335, -71.3103),
    ("Río Gallegos", "Argentina"): (-51.6230, -69.2168),
    ("Corrientes", "Argentina"): (-27.4692, -58.8306),
    ("La Paz", "Bolivia"): (-16.4897, -68.1193),
    ("Santa Cruz de la Sierra", "Bolivia"): (-17.7833, -63.1822),
    ("Cochabamba", "Bolivia"): (-17.3895, -66.1568),
    ("Sucre", "Bolivia"): (-19.0196, -65.2619),
    ("Brasília", "Brazil"): (-15.8267, -47.9218),
    ("São Paulo", "Brazil"): (-23.5505, -46.6333),
    ("Rio de Janeiro", "Brazil"): (-22.9068, -43.1729),
    ("Salvador", "Brazil"): (-12.9714, -38.5014),
    ("Fortaleza", "Brazil"): (-3.7172, -38.5433),
    ("Belo Horizonte", "Brazil"): (-19.9167, -43.9345),
    ("Manaus", "Brazil"): (-3.1190, -60.0217),
    ("Curitiba", "Brazil"): (-25.4284, -49.2733),
    ("Recife", "Brazil"): (-8.0476, -34.8770),
    ("Porto Alegre", "Brazil"): (-30.0346, -51.2177),
    ("Belém", "Brazil"): (-1.4558, -48.4902),
    ("Goiânia", "Brazil"): (-16.6869, -49.2648),
    ("Guarulhos", "Brazil"): (-23.4543, -46.5337),
    ("Campinas", "Brazil"): (-22.9099, -47.0626),
    ("São Luís", "Brazil"): (-2.5307, -44.2963),
    ("Santiago", "Chile"): (-33.4489, -70.6693),
    ("Valparaíso", "Chile"): (-33.0472, -71.6127),
    ("Concepción", "Chile"): (-36.8270, -73.0503),
    ("Antofagasta", "Chile"): (-23.6509, -70.3975),
    ("Punta Arenas", "Chile"): (-53.1638, -70.9171),
    ("Bogotá", "Colombia"): (4.7110, -74.0721),
    ("Medellín", "Colombia"): (6.2442, -75.5812),
    ("Cali", "Colombia"): (3.4516, -76.5320),
    ("Barranquilla", "Colombia"): (10.9685, -74.7813),
    ("Cartagena", "Colombia"): (10.3910, -75.4794),
    ("Valledupar", "Colombia"): (10.4631, -73.2532),
    ("Quito", "Ecuador"): (-0.1807, -78.4678),
    ("Guayaquil", "Ecuador"): (-2.1710, -79.9224),
    ("Cuenca", "Ecuador"): (-2.9001, -79.0059),
    ("Georgetown", "Guyana"): (6.8013, -58.1551),
    ("Asunción", "Paraguay"): (-25.2637, -57.5759),
    ("Lima", "Peru"): (-12.0464, -77.0428),
    ("Arequipa", "Peru"): (-16.4090, -71.5375),
    ("Trujillo", "Peru"): (-8.1091, -79.0215),
    ("Cusco", "Peru"): (-13.5319, -71.9675),
    ("Iquitos", "Peru"): (-3.7491, -73.2538),
    ("Paramaribo", "Suriname"): (5.8520, -55.2038),
    ("Montevideo", "Uruguay"): (-34.9011, -56.1645),
    ("Caracas", "Venezuela"): (10.4806, -66.9036),
    ("Maracaibo", "Venezuela"): (10.6666, -71.6125),
    ("Valencia", "Venezuela"): (10.1620, -68.0071),
    ("Barquisimeto", "Venezuela"): (10.0647, -69.3570),

    # Oceania
    ("Canberra", "Australia"): (-35.2809, 149.1300),
    ("Sydney", "Australia"): (-33.8688, 151.2093),
    ("Melbourne", "Australia"): (-37.8136, 144.9631),
    ("Brisbane", "Australia"): (-27.4698, 153.0251),
    ("Perth", "Australia"): (-31.9505, 115.8605),
    ("Adelaide", "Australia"): (-34.9285, 138.6007),
    ("Hobart", "Australia"): (-42.8821, 147.3272),
    ("Darwin", "Australia"): (-12.4634, 130.8456),
    ("Cairns", "Australia"): (-16.9186, 145.7781),
    ("Alice Springs", "Australia"): (-23.6980, 133.8807),
    ("Townsville", "Australia"): (-19.2590, 146.8169),
    ("Launceston", "Australia"): (-41.4332, 147.1441),
    ("Burnie", "Australia"): (-41.0511, 145.9069),
    ("Dampier", "Australia"): (-20.6617, 116.7117),
    ("Suva", "Fiji"): (-18.1416, 178.4415),
    ("Tarawa", "Kiribati"): (1.4518, 172.9717),
    ("Majuro", "Marshall Islands"): (7.0897, 171.3803),
    ("Palikir", "Micronesia"): (6.9248, 158.1610),
    ("Yaren", "Nauru"): (-0.5477, 166.9209),
    ("Nouméa", "New Caledonia"): (-22.2558, 166.4505),
    ("Auckland", "New Zealand"): (-36.8509, 174.7645),
    ("Wellington", "New Zealand"): (-41.2924, 174.7787),
    ("Christchurch", "New Zealand"): (-43.5321, 172.6362),
    ("Hamilton", "New Zealand"): (-37.7870, 175.2793),
    ("Tauranga", "New Zealand"): (-37.6878, 176.1651),
    ("Dunedin", "New Zealand"): (-45.8788, 170.5028),
    ("Napier", "New Zealand"): (-39.4928, 176.9120),
    ("Invercargill", "New Zealand"): (-46.4132, 168.3538),
    ("Nelson", "New Zealand"): (-41.2706, 173.2840),
    ("Rotorua", "New Zealand"): (-38.1368, 176.2497),
    ("Melekeok", "Palau"): (7.4874, 134.6265),
    ("Port Moresby", "Papua New Guinea"): (-9.4438, 147.1803),
    ("Apia", "Samoa"): (-13.8333, -171.7500),
    ("Honiara", "Solomon Islands"): (-9.4456, 159.9729),
    ("Nukualofa", "Tonga"): (-21.2114, -175.1998),
    ("Funafuti", "Tuvalu"): (-8.5211, 179.1962),
    ("Port Vila", "Vanuatu"): (-17.7334, 168.3220),
}

def main():
    print("Loading cities from database...")
    cities = get_cities_from_db()
    print(f"Found {len(cities)} cities")

    # Add coordinates from pre-defined list
    cities_with_coords = []
    missing_coords = []

    for city in cities:
        key = (city['city'], city['country'])
        if key in CITY_COORDS:
            city['lat'], city['lng'] = CITY_COORDS[key]
            cities_with_coords.append(city)
        else:
            missing_coords.append(key)

    print(f"Cities with coordinates: {len(cities_with_coords)}")
    print(f"Cities missing coordinates: {len(missing_coords)}")

    if missing_coords:
        print("\nMissing coordinates for:")
        for city, country in missing_coords[:20]:
            print(f"  {city}, {country}")
        if len(missing_coords) > 20:
            print(f"  ... and {len(missing_coords) - 20} more")

    # Export to JSON
    output = {
        'cities': cities_with_coords,
        'metadata': {
            'total_cities': len(cities_with_coords),
            'continents': list(set(c['continent'] for c in cities_with_coords)),
            'countries': list(set(c['country'] for c in cities_with_coords))
        }
    }

    with open('temperature_data.json', 'w') as f:
        json.dump(output, f, indent=2)

    print(f"\nExported {len(cities_with_coords)} cities to temperature_data.json")

if __name__ == '__main__':
    main()
